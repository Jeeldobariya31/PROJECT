<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Student Attendance Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      .highlight {
        background-color: #d1ecf1 !important;
      }
    </style>
  </head>
  <body>
    <div class="container mt-4">
      <h1 class="text-center mb-4">Student Attendance Tracker</h1>

      <div class="d-flex justify-content-between mb-3">
        <div>
          <strong>Present:</strong> <span id="presentCount">0</span><br>
          <strong>Absent:</strong> <span id="absentCount">0</span>
        </div>
        <div>
          <button class="btn btn-success me-2" onclick="markAllPresent()">All Present</button>
          <button class="btn btn-warning me-2" onclick="showAbsentStudents()">Absent Students</button>
          <button class="btn btn-danger" onclick="resetAttendance()">Reset Attendance</button>
        </div>
      </div>

      <table class="table table-bordered">
        <thead class="table-light">
          <tr>
            <th>Roll No.</th>
            <th>Student Name</th>
            <th>Enrollment No.</th>
            <th>Present/Absent</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="studentTable"></tbody>
      </table>
    </div>

    <script>
      const student = [
        { name: 'Gambhava Krushi', enroll: '074' },
        { name: 'Gambhava Krushi', enroll: '074' }
      ];

      const tbody = document.getElementById("studentTable");
      const presentCount = document.getElementById("presentCount");
      const absentCount = document.getElementById("absentCount");

      let totalPresent = 0;
      let totalAbsent = 0;
      let rows = [];
      let currentIndex = 0;

      for (let i = 101; i < 201; i++) {
        const index = i % student.length;
        const row = document.createElement("tr");

        row.innerHTML = `
          <td class="roll">${i}</td>
          <td>${student[index].name}</td>
          <td>24010101${student[index].enroll}</td>
          <td>
            <button onclick="markPresent(this)" class="btn btn-outline-success btn-sm me-1">Present</button>
            <button onclick="markAbsent(this)" class="btn btn-outline-danger btn-sm">Absent</button>
          </td>
          <td class="status text-secondary">Pending</td>
        `;

        tbody.appendChild(row);
        rows.push(row);
      }

      // Initial highlight
      highlightRow(0);

      function markPresent(button) {
        const row = button.closest('tr');
        const statusCell = row.querySelector('.status');
        if (statusCell.innerText !== "Present") {
          if (statusCell.innerText === "Absent") totalAbsent--;
          if (statusCell.innerText !== "Present") totalPresent++;
          statusCell.innerText = "Present";
          statusCell.style.color = "green";
          updateCount();
        }
      }

      function markAbsent(button) {
        const row = button.closest('tr');
        const statusCell = row.querySelector('.status');
        if (statusCell.innerText !== "Absent") {
          if (statusCell.innerText === "Present") totalPresent--;
          if (statusCell.innerText !== "Absent") totalAbsent++;
          statusCell.innerText = "Absent";
          statusCell.style.color = "red";
          updateCount();
        }
      }

      function updateCount() {
        presentCount.innerText = totalPresent;
        absentCount.innerText = totalAbsent;
      }

      function showAbsentStudents() {
        let absentRolls = [];

        rows.forEach(row => {
          const status = row.querySelector(".status").innerText;
          const roll = row.querySelector(".roll").innerText;
          if (status === "Absent") {
            absentRolls.push(roll);
          }
        });

        if (absentRolls.length > 0) {
          alert("Absent Students Roll No: " + absentRolls.join(", "));
        } else {
          alert("No students marked as absent.");
        }
      }

      function resetAttendance() {
        rows.forEach(row => {
          const statusCell = row.querySelector(".status");
          statusCell.innerText = "Pending";
          statusCell.style.color = "gray";
        });
        totalPresent = 0;
        totalAbsent = 0;
        updateCount();
        highlightRow(0);
      }

      function markAllPresent() {
        rows.forEach(row => {
          const statusCell = row.querySelector(".status");
          if (statusCell.innerText === "Absent") {
            totalAbsent--;
            totalPresent++;
          } else if (statusCell.innerText === "Pending") {
            totalPresent++;
          }
          statusCell.innerText = "Present";
          statusCell.style.color = "green";
        });
        updateCount();
      }

      // âœ… Row navigation + speech
      function highlightRow(index) {
        rows.forEach((row, i) => {
          row.classList.toggle("highlight", i === index);
        });

        const roll = rows[index].querySelector(".roll").innerText;
        speak("Roll number " + roll);
      }

      function speak(text) {
        if ('speechSynthesis' in window) {
          const utterance = new SpeechSynthesisUtterance(text);
          window.speechSynthesis.cancel(); // Stop previous speech
          window.speechSynthesis.speak(utterance);
        }
      }

      document.addEventListener("keydown", function (e) {
        if (e.key === "ArrowUp") {
          if (currentIndex > 0) {
            currentIndex--;
            highlightRow(currentIndex);
          }
        } else if (e.key === "ArrowDown") {
          if (currentIndex < rows.length - 1) {
            currentIndex++;
            highlightRow(currentIndex);
          }
        }
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>